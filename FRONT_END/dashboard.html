<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Dashboard</title>
    <link rel="stylesheet" href="style56.css">
    <link rel="icon" href="images/PD-Logo.png">  
</head>

<body>
  <!-- Greeting + Clock -->
  <div class="glass">
    <h1 id="greeting">Hello, PD!</h1>
    <div id="clock">00:00:00</div>
    <span id="themeSwitcher">Switch Theme</span>
  </div>

  <!-- Goal -->
  <div class="glass">
    <h2>Today's Goal</h2>
    <input type="text" id="goalInput" placeholder="Your goal for today">
    <button onclick="saveGoal()">Save</button>
    <p id="savedGoal"></p>
  </div>

  <!-- Quote -->
  <div class="glass">
    <h2>Quote of the Day</h2>
    <p id="quote">Loading...</p>
  </div>

  <!-- To-Do List -->
  <div class="glass">
    <h2>To-Do List</h2>
    <input type="text" id="todoInput" placeholder="Add new task">
    <button onclick="addTodo()">Add</button>
    <ul id="todoList"></ul>
  </div>

  <!-- Pomodoro -->
  <div class="glass">
    <h2>Pomodoro Timer</h2>
    <p id="pomodoro">25:00</p>
    <button onclick="startPomodoro()">Start</button>
    <button onclick="resetPomodoro()">Reset</button>
  </div>

  <!-- Weather -->
  <div class="glass">
    <h2>Weather</h2>
    <p id="weather">Loading...</p>
  </div>

  <!-- Countdown -->
  <div class="glass">
    <h2>Countdown</h2>
    <input type="date" id="countdownDate">
    <button onclick="saveCountdown()">Set Date</button>
    <p id="countdown"></p>
  </div>

  <!-- Journal -->
  <div class="glass">
    <h2>Daily Journal</h2>
    <textarea id="journal" rows="5" placeholder="Write your thoughts..."></textarea>
    <button onclick="saveJournal()">Save</button>
  </div>

  <script>
    // Greeting
    const greeting = document.getElementById('greeting');
    const hours = new Date().getHours();
    if (hours < 12) {
      greeting.textContent = "Good Morning, PD!";
    } else if (hours < 18) {
      greeting.textContent = "Good Afternoon, PD!";
    } else {
      greeting.textContent = "Good Evening, PD!";
    }

    // Clock
    function updateClock() {
      const now = new Date();
      const h = String(now.getHours()).padStart(2, '0');
      const m = String(now.getMinutes()).padStart(2, '0');
      const s = String(now.getSeconds()).padStart(2, '0');
      document.getElementById('clock').textContent = `${h}:${m}:${s}`;
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Theme Switcher (use class toggle)
    const themeBtn = document.getElementById('themeSwitcher');
    themeBtn.onclick = () => {
      document.body.classList.toggle('dark');
    };

    // Goal
    const savedGoal = document.getElementById('savedGoal');
    const goalInput = document.getElementById('goalInput');
    function saveGoal() {
      const goal = goalInput.value.trim();
      if (goal) {
        localStorage.setItem('dailyGoal', goal);
        savedGoal.textContent = "✅ " + goal;
        goalInput.value = "";
      }
    }
    const storedGoal = localStorage.getItem('dailyGoal');
    if (storedGoal) savedGoal.textContent = "✅ " + storedGoal;

    // Quote (API)
    fetch('https://api.quotable.io/random')
      .then(res => res.json())
      .then(data => document.getElementById('quote').textContent = `"${data.content}" — ${data.author}`)
      .catch(() => document.getElementById('quote').textContent = "Be the change you wish to see.");

    // To-Do
    const todoList = document.getElementById('todoList');
    const todos = JSON.parse(localStorage.getItem('todos')) || [];
    function renderTodos() {
      todoList.innerHTML = "";
      todos.forEach((todo, i) => {
        const li = document.createElement('li');
        li.textContent = todo.text;
        li.className = todo.done ? "done" : "";
        li.onclick = () => {
          todos[i].done = !todos[i].done;
          saveTodos();
        };
        todoList.appendChild(li);
      });
    }
    function addTodo() {
      const todoInput = document.getElementById('todoInput');
      const text = todoInput.value.trim();
      if (text) {
        todos.push({ text, done: false });
        saveTodos();
        todoInput.value = "";
      }
    }
    function saveTodos() {
      localStorage.setItem('todos', JSON.stringify(todos));
      renderTodos();
    }
    renderTodos();

    // Pomodoro (fixed)
    let pomoTime = 25 * 60;
    let pomoInterval = null;

    function updatePomodoro() {
      const mins = String(Math.floor(pomoTime / 60)).padStart(2, '0');
      const secs = String(pomoTime % 60).padStart(2, '0');
      document.getElementById('pomodoro').textContent = `${mins}:${secs}`;
    }

    function startPomodoro() {
      if (pomoInterval) return; // don’t start twice
      pomoInterval = setInterval(() => {
        if (pomoTime > 0) {
          pomoTime--;
          updatePomodoro();
        } else {
          clearInterval(pomoInterval);
          pomoInterval = null;
          alert("Pomodoro done! Take a break.");
        }
      }, 1000);
    }

    function resetPomodoro() {
      clearInterval(pomoInterval);
      pomoInterval = null;
      pomoTime = 25 * 60;
      updatePomodoro();
    }

    updatePomodoro();

    // Weather
    navigator.geolocation.getCurrentPosition(pos => {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      const apiKey = 'f44990f76095b0423e4a437969834c48'; 
      fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`)
        .then(res => res.json())
        .then(data => {
          document.getElementById('weather').textContent =
            `${data.name}: ${data.main.temp}°C, ${data.weather[0].main}`;
        })
        .catch(() => {
          document.getElementById('weather').textContent = "Couldn't fetch weather.";
        });
    });

    // Countdown
    const countdown = document.getElementById('countdown');
    const savedDate = localStorage.getItem('countdownDate');
    if (savedDate) updateCountdown(savedDate);
    function saveCountdown() {
      const date = document.getElementById('countdownDate').value;
      localStorage.setItem('countdownDate', date);
      updateCountdown(date);
    }
    function updateCountdown(date) {
      const now = new Date();
      const target = new Date(date);
      const diff = target - now;
      if (diff > 0) {
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        countdown.textContent = `${days} days remaining`;
      } else {
        countdown.textContent = "The date has passed!";
      }
    }

    // Journal
    const journal = document.getElementById('journal');
    journal.value = localStorage.getItem('journal') || "";
    function saveJournal() {
      localStorage.setItem('journal', journal.value);
      alert("Journal saved!");
    }
  </script>
</body>
</html>
